# GerryChainShapefileTest
Run tests to confirm that the Python &amp; Julia GerryChains produce the same adjacency matrices after reading in shapefiles

## Shapefiles
You can download shapefiles from [mggg-states](https://github.com/mggg-states). Download the `.zip` file located in any of the [state]-shapefiles repositories, and then extract in the root folder of this repository. You should see (at least) a `.shp` and `.dbf` file in the resulting folder. I've already included the shapefile folders from Indiana, Virginia, Utah, and Minnesota 2012 precincts, all of which were downloaded from mggg-states.

## Performing a test
The "test" we're interested in involves three steps. First, we read in a shapefile using the Python version of `GerryChain`, and then dump the resulting adjacency matrix (as well as the unique IDs of the geographical units that correspond to each row/column of this adjacency matrix in order) to a JSON file. Next, we do the same with Julia. Finally, we compare the resulting JSON dumps and confirm that they contain the same information. 

If you wanted to run this test for Utah precincts, ensuring that the adjacency matrices generated by Python and Julia (using the queen adjacency method) were identical you would run the following series of commands: 
```
python load_graph.py --shp_path ./UT_precincts/UT_precincts.shp --adjacency queen --id_key PrcncID --filename p_ut_queen.json
# some output printed - you may see lots of warnings from GerryChain here, that's to be expected
julia load_graph.jl --prefix ./UT_precincts/UT_precincts --adjacency queen --id_key PrcncID --filename j_ut_queen.json
# some output
julia compare_outputs.jl --json1 p_ut_queen.json --json2 j_ut_queen.json
# results!
```
Note that the time each command takes to run can be anywhere from 5-15 minutes, depending on your machine.
(**N.B.** for the Python script, you pass the full path to the `.shp` file, while for the Julia script, you pass the full path, minus the `.shp` extension.)
